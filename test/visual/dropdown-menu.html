<!DOCTYPE html>

<head lang="en">
  <meta charset="UTF-8">
  <title>Drop down menu tests</title>
  <script src="../../../webcomponentsjs/webcomponents-lite.js"></script>
  <link rel="import" href="../../../polymer/polymer.html">
  <link rel="import" href="../../../vaadin-list-box/vaadin-list-box.html">
  <link rel="import" href="../../../vaadin-item/vaadin-item.html">
  <link rel="import" href="../../vaadin-dropdown-menu.html">
</head>

<body>
  <style>
    body {
      font-family: sans-serif;
    }

    .capture-block {
      display: inline-block;
      width: 800px;
    }
  </style>

  <div class="capture-block" id="dropdown-menu">
    <vaadin-dropdown-menu label="Open" placeholder="Placeholder" id="drop1">
      <template>
        <vaadin-list-box>
          <vaadin-item>Item one</vaadin-item>
          <vaadin-item>Item two</vaadin-item>
          <vaadin-item disabled>Item three</vaadin-item>
        </vaadin-list-box>
      </template>
    </vaadin-dropdown-menu>

    <vaadin-dropdown-menu label="Normal" placeholder="Placeholder">
      <div slot="prefix">prefix &nbsp;</div>
    </vaadin-dropdown-menu>

    <vaadin-dropdown-menu label="Disabled" placeholder="Placeholder" disabled>
    </vaadin-dropdown-menu>

    <vaadin-dropdown-menu label="Selected and Focused" placeholder="Placeholder" id="drop2">
      <template>
        <vaadin-list-box>
          <vaadin-item>Selected and Focused</vaadin-item>
        </vaadin-list-box>
      </template>
    </vaadin-dropdown-menu>

    <br/>

    <vaadin-dropdown-menu label="Space">
      This is intentional
    </vaadin-dropdown-menu>

    <vaadin-dropdown-menu label="Item as value" placeholder="Placeholder" id="drop3">
      <template>
        <vaadin-list-box>
          <vaadin-item><strong>Item</strong>&nbsp;as&nbsp;<i>Value</i></vaadin-item>
        </vaadin-list-box>
      </template>
    </vaadin-dropdown-menu>

    <vaadin-dropdown-menu label="Text as value" placeholder="Placeholder" id="drop4">
      <template>
        <vaadin-list-box>
          <vaadin-item>Text as value</vaadin-item>
        </vaadin-list-box>
      </template>
    </vaadin-dropdown-menu>

    <vaadin-dropdown-menu label="Label as value" placeholder="Placeholder" id="drop5">
      <template>
        <vaadin-list-box>
          <vaadin-item label="Label as value">Option three</vaadin-item>
        </vaadin-list-box>
      </template>
    </vaadin-dropdown-menu>

    <script>
      window.addEventListener('WebComponentsReady', () => {
        const drop1 = document.getElementById('drop1');
        drop1.opened = true;

        function select(id, cb, idx) {
          const drop = document.getElementById(id);
          drop.opened = true;
          Polymer.RenderStatus.afterNextRender(drop._menuElement, () => {
            drop._menuElement.selected = idx || 0;
            cb && cb(drop);
          });
        }

        // This opens and selects an item. Then it removes focus (needed in FF)
        ['drop3', 'drop4', 'drop5'].forEach(id => select(id, drop => drop.focusElement.blur()));

        // Using a timeout to so the the last dropdown selected keeps the focus in the screenshot
        setTimeout(() => select('drop2', drop => window.webComponentsAreReady = true), 100);
      });
    </script>

  </div>
</body>
